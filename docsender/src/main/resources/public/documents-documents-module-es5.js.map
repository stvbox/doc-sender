{"version":3,"sources":["webpack:///src/app/documents/document-extend/document-extend.component.ts","webpack:///src/app/documents/document-extend/document-extend.component.html","webpack:///src/app/documents/document-list/document-list.component.ts","webpack:///src/app/documents/document-list/document-list.component.html","webpack:///src/app/documents/document.service.ts","webpack:///src/app/documents/document/document.component.ts","webpack:///src/app/documents/document/document.component.html","webpack:///src/app/documents/documents-routing.module.ts","webpack:///src/app/documents/documents.module.ts"],"names":["DocumentExtendComponent","fb","documentSvc","errors","form","group","extend","description","busyState","attributes","value","documentType","postExtendDocument","pipe","applyErrors","unsubscribe","subscribe","result","sentState","reduce","memo","error","errorCode","code","split","selector","templateUrl","styleUrls","PAGE_SIZE","DocumentListComponent","currentPage","documents","documentsPage","page","getDocuments","data","length","response","pageNum","offset","i","next","nextPage","DocumentService","http","params","observe","responseType","String","get","console","log","body","document","post","providedIn","DocumentComponent","descriptionText","postDocument","sendDocument","routes","path","component","DocumentsRoutingModule","forChild","imports","exports","DocumentsModule","declarations","providers"],"mappings":"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","file":"documents-documents-module-es5.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { FormControl, FormBuilder, FormGroup } from '@angular/forms';\nimport { DocumentService } from '../document.service';\nimport { takeUntil, catchError } from 'rxjs/operators';\nimport { BaseComponent } from '../../common/BaseComponent';\nimport { never } from 'rxjs';\nimport { isNil } from 'lodash';\n\ninterface FormError {\n\tcode: String;\n}\n\n@Component({\n\tselector: 'document',\n\ttemplateUrl: './document-extend.component.html',\n\tstyleUrls: ['./document-extend.component.scss']\n})\nexport class DocumentExtendComponent extends BaseComponent implements OnInit {\n\tform: FormGroup;\n\tsentState: boolean;\n\tbusyState: boolean;\n\terrors = {};\n\n\tconstructor(\n\t\tprivate fb: FormBuilder,\n\t\tprivate documentSvc: DocumentService,\n\t) {\n\t\tsuper();\n\t}\n\n\tngOnInit(): void {\n\t\tthis.form = this.fb.group({\n\t\t\textend: [],\n\t\t\tdescription: [],\n\t\t});\n\t}\n\n\tsendDocument() {\n\t\tthis.busyState = true;\n\t\tconst attributes = { ...this.form.value };\n\t\tconst documentType = 'extend';\n\t\tthis.documentSvc.postExtendDocument({ attributes, documentType }).pipe(\n\t\t\tcatchError((errors) => {\n\t\t\t\tthis.busyState = false;\n\t\t\t\tthis.applyErrors(errors);\n\t\t\t\tthrow (errors);\n\t\t\t}),\n\t\t\ttakeUntil(this.unsubscribe),\n\t\t).subscribe((result) => {\n\t\t\tthis.busyState = false;\n\t\t\tthis.sentState = true;\n\t\t\tthis.applyErrors(null);\n\t\t});\n\t}\n\n\tapplyErrors(errors: Array<FormError>) {\n\n\t\tif (isNil(errors)) {\n\t\t\tthis.errors = {};\n\t\t\treturn;\n\t\t}\n\n\t\tthis.errors = errors.reduce((memo, error) => {\n\t\t\tconst errorCode = error.code.split('_')[1];\n\t\t\tmemo[errorCode] = true;\n\t\t\treturn memo;\n\t\t}, {});\n\n\t}\n\n}\n","<div class=\"d-flex\">\n\t<div class=\"container\">\n\t\t<div class=\"row\">\n\t\t\t<div class=\"col\">\n\t\t\t\t<div [formGroup]=\"form\"\n\t\t\t\t\t class=\"card\">\n\t\t\t\t\t<div class=\"card-header\">\n\t\t\t\t\t\tФорма простого документа для примера\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"card-body\">\n\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t<label for=\"extendField\">Дополнительное поле</label>\n\t\t\t\t\t\t\t<input formControlName=\"extend\"\n\t\t\t\t\t\t\t\t   [ngClass]=\"{ 'is-invalid': errors['extend'] }\"\n\t\t\t\t\t\t\t\t   type=\"email\"\n\t\t\t\t\t\t\t\t   class=\"form-control\"\n\t\t\t\t\t\t\t\t   id=\"extendField\"\n\t\t\t\t\t\t\t\t   aria-describedby=\"extendHelp\">\n\t\t\t\t\t\t\t<small id=\"extend\"\n\t\t\t\t\t\t\t\t   class=\"form-text text-muted\">Поле расширяющее базовую сущьность.</small>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t<label for=\"exampleFormControlTextarea\">Описание</label>\n\t\t\t\t\t\t\t<textarea formControlName=\"description\"\n\t\t\t\t\t\t\t\t\t  [ngClass]=\"{ 'is-invalid': errors['description'] }\"\n\t\t\t\t\t\t\t\t\t  class=\"form-control is-invalid\"\n\t\t\t\t\t\t\t\t\t  id=\"exampleFormControlTextarea\"\n\t\t\t\t\t\t\t\t\t  rows=\"3\"></textarea>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button *ngIf=\"!this.busyState\"\n\t\t\t\t\t\t\t\t(click)=\"sendDocument()\">отправить</button>\n\t\t\t\t\t\t<img *ngIf=\"this.busyState\"\n\t\t\t\t\t\t\t src=\"/assets/images/svg/spinner.svg\"\n\t\t\t\t\t\t\t alt=\"Загрузка...\">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n","import { Component, OnInit } from '@angular/core';\r\nimport { takeUntil, switchMap, map, filter } from 'rxjs/operators';\r\nimport { BaseComponent } from '../../common/BaseComponent';\r\nimport { DocumentService } from '../document.service';\r\nimport { Subject } from 'rxjs';\r\nimport { isNil } from 'lodash';\r\n\r\nconst PAGE_SIZE = 5;\r\n\r\ninterface Pagedocument {\r\n\tdocuments: any[];\r\n\tpage: number;\r\n}\r\n\r\n@Component({\r\n\tselector: 'app-document-list',\r\n\ttemplateUrl: './document-list.component.html',\r\n\tstyleUrls: ['./document-list.component.scss'],\r\n})\r\nexport class DocumentListComponent extends BaseComponent implements OnInit {\r\n\tcurrentPage: number = 0;\r\n\tdocuments: any[] = [];\r\n\tdocumentsPage: Subject<number> = new Subject();\r\n\r\n\tconstructor(private documentSvc: DocumentService) {\r\n\t\tsuper();\r\n\t}\r\n\tngOnInit(): void {\r\n\t\tthis.documentsPage.pipe(\r\n\t\t\tswitchMap((page) => this.documentSvc.getDocuments(page)),\r\n\t\t\tfilter(({ data }) => data?.length),\r\n\t\t\ttakeUntil(this.unsubscribe),\r\n\t\t).subscribe((response) => {\r\n\t\t\tconst { data: documents, pageNum: page } = response;\r\n\t\t\tthis.currentPage = page;\r\n\t\t\tconst offset = PAGE_SIZE * page;\r\n\t\t\tfor (let i = 0; i < PAGE_SIZE; i++) {\r\n\t\t\t\tthis.documents[offset + i] = documents[i];\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tthis.documentsPage.next(this.currentPage);\r\n\t}\r\n\r\n\tnextPage() {\r\n\t\tthis.documentsPage.next(this.currentPage + 1);\r\n\t}\r\n}\r\n","<table class=\"table table-bordered\">\n\t<thead>\n\t\t<tr>\n\t\t\t<th scope=\"col\">#</th>\n\t\t\t<th scope=\"col\">Дата</th>\n\t\t\t<th scope=\"col\">Описание</th>\n\t\t\t<th scope=\"col\">Статус</th>\n\t\t</tr>\n\t</thead>\n\t<tbody>\n\t\t<tr *ngFor=\"let document of documents\">\n\t\t\t<th scope=\"row\">{{ document.id }}</th>\n\t\t\t<td>{{ document.created }}</td>\n\t\t\t<td>{{ document.description }}</td>\n\t\t\t<td>{{ document.status }}</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n<div>\n\t<button (click)=\"nextPage()\">показать еще</button>\n</div>\n","import { Injectable } from '@angular/core';\nimport { HttpClient, HttpXsrfTokenExtractor, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { map, catchError, tap } from 'rxjs/operators';\nimport { of } from 'rxjs';\nimport { BaseDocument } from './BaseDocument';\nimport { Response } from '../common/response';\n\ninterface Options {\n\theaders?: HttpHeaders | {\n\t\t[header: string]: string | string[];\n\t};\n\tobserve: 'response';\n\tparams?: HttpParams | {\n\t\t[param: string]: string | string[];\n\t};\n\treportProgress?: boolean;\n\tresponseType?: 'json';\n\twithCredentials?: boolean;\n};\n\n@Injectable({\n\tprovidedIn: 'root'\n})\nexport class DocumentService {\n\tconstructor(private http: HttpClient) { }\n\n\tgetDocuments(page: number) {\n\t\tconst params: Options = {\n\t\t\tobserve: 'response',\n\t\t\tresponseType: 'json',\n\t\t\tparams: {\n\t\t\t\tpage: String(page)\n\t\t\t}\n\t\t};\n\t\treturn this.http.get<Response<any>>('/api/document/get-list', params).pipe(\n\t\t\ttap((response) => console.log(response)),\n\t\t\tcatchError((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t\treturn of(null);\n\t\t\t}),\n\t\t\tmap((response) => response.body),\n\t\t);\n\t}\n\n\tpostDocument(document: BaseDocument) {\n\t\treturn this.http.post<Response<any>>('/api/document/post', document).pipe(\n\t\t\tcatchError((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t\treturn of(null);\n\t\t\t}),\n\t\t\tmap((response) => response.data),\n\t\t);\n\t}\n\n\tpostExtendDocument(document: BaseDocument) {\n\t\treturn this.http.post<Response<any>>('/api/extend/post', document).pipe(\n\t\t\tcatchError((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t\treturn of(null);\n\t\t\t}),\n\t\t\tmap((response) => {\n\t\t\t\tif (response?.data?.errors) {\n\t\t\t\t\tthrow (response.data.errors);\n\t\t\t\t}\n\t\t\t\treturn response?.data;\n\t\t\t}),\n\t\t);\n\t}\n\n}\n","import { Component, OnInit } from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { DocumentService } from '../document.service';\nimport { takeUntil } from 'rxjs/operators';\nimport { BaseComponent } from '../../common/BaseComponent';\nimport { TestService } from '../test.service';\n\n@Component({\n\tselector: 'document',\n\ttemplateUrl: './document.component.html',\n\tstyleUrls: ['./document.component.scss'],\n})\nexport class DocumentComponent extends BaseComponent implements OnInit {\n\n\tdescriptionText: FormControl = new FormControl();\n\n\tconstructor(private documentSvc: DocumentService) {\n\t\tsuper();\n\t}\n\n\tngOnInit(): void {\n\n\t}\n\n\tsendDocument() {\n\t\tconst attributes = { description: this.descriptionText.value };\n\t\tconst documentType = 'simple';\n\t\tthis.documentSvc.postDocument({ attributes, documentType }).pipe(\n\t\t\ttakeUntil(this.unsubscribe),\n\t\t).subscribe((result) => {\n\t\t\tconsole.log(result);\n\t\t});\n\t}\n\n}\n","<div class=\"d-flex\">\n\t<div class=\"container\">\n\t\t<div class=\"row\">\n\t\t\t<div class=\"col\">\n\t\t\t\t<div class=\"card\">\n\t\t\t\t\t<div class=\"card-header\">\n\t\t\t\t\t\tФорма простого документа для примера\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"card-body\">\n\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t<label for=\"exampleFormControlTextarea1\">Описание</label>\n\t\t\t\t\t\t\t<textarea [formControl]=\"descriptionText\"\n\t\t\t\t\t\t\t\t\t  class=\"form-control\"\n\t\t\t\t\t\t\t\t\t  id=\"exampleFormControlTextarea1\"\n\t\t\t\t\t\t\t\t\t  rows=\"3\"></textarea>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<button (click)=\"sendDocument()\" >отправить</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { DocumentComponent } from './document/document.component';\nimport { DocumentExtendComponent } from './document-extend/document-extend.component';\nimport { DocumentListComponent } from './document-list/document-list.component';\n\nconst routes: Routes = [\n\t{ path: '', component: DocumentListComponent },\n\t{ path: 'simple', component: DocumentComponent },\n\t{ path: 'extend', component: DocumentExtendComponent },\n];\n\n@NgModule({\n\timports: [RouterModule.forChild(routes)],\n\texports: [RouterModule]\n})\nexport class DocumentsRoutingModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { DocumentsRoutingModule } from './documents-routing.module';\nimport { DocumentComponent } from './document/document.component';\nimport { ReactiveFormsModule } from '@angular/forms';\nimport { DocumentExtendComponent } from './document-extend/document-extend.component';\nimport { DocumentService } from './document.service';\nimport { HttpClientModule, HttpClientXsrfModule } from '@angular/common/http';\nimport { TestService } from './test.service';\nimport { DocumentListComponent } from './document-list/document-list.component';\n\n\n@NgModule({\n\tdeclarations: [\n\t\tDocumentComponent,\n\t\tDocumentExtendComponent,\n\t\tDocumentListComponent,\n\t],\n\timports: [\n\t\tCommonModule,\n\t\tDocumentsRoutingModule,\n\t\tReactiveFormsModule,\n\t],\n\tproviders: [\n\t\tDocumentService\n\t],\n})\nexport class DocumentsModule { }\n"]}